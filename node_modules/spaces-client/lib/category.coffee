# Test commands:
#
# I wanted to post form data to achieve a more representative performance profile, but the node wizard complicated it so I switched over to json;
#
# curl -X POST -H "Cookie:_social_navigator_session=KRK4x-fEw24cTQ8c8BuKmLjJTYY" -H "ACCEPT:application/vnd.moxiesoft.spaces-v1+json" --data-urlencode "node[_type]=Category&node[title]=eos+quos&node[body]=error+expedita" https://xxkylee.moxiedev.com/categories/wizard_create
#
# data = $.param {
#   node: {
#     _type: "Category",
#     title: Faker.Lorem.sentences(1),
#     body: Faker.Lorem.sentences(4)
#   }
# }
#
# xhr.open('POST', site.full_url + "/categories/wizard_create", true)
# xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded")
#
# Here's the JSON version:
#
# curl -X POST -H "Cookie:_social_navigator_session=rGbu73bk-gXSbv23lDWWlqxLnC0" -H "CONTENT-TYPE:application/json" -H "ACCEPT:application/vnd.moxiesoft.spaces-v1+json" -d '{"category":{"title":"laboriosam laudantium vel omnis aut molestiae aut in","body":"blanditiis et nemo sed et nesciunt exercitationem\nprovident harum enim sapiente\nprovident ut molestiae possimus recusandae iste exercitationem qui dignissimos\nrepellendus itaque quisquam laudantium"}}' https://xxgonzalo.moxiedev.com/categories

# TODO - convert to form post instead of JSON
class Category
  Faker = require('Faker')
  Resource = require("./resource")

  @showCategory = (site, sessionId, resourceId, parentId, userId, onsuccess, onfail) ->
    addlHeaders = {
      "Accept": "application/vnd.moxiesoft.spaces-v1+json",
      "Cookie": ["_social_navigator_session=" + sessionId, "path=/"]
    }
    Resource.getResource(site, userId, sessionId, 'categories/' + resourceId, addlHeaders, ((res) ->
      onsuccess()
    ), (() ->
      onfail()
    ))

  @createCategory = (site, sessionId, resourceId, parentId, userId, onsuccess, onfail, oncreate) ->
    data = {
      category: {
        title: Faker.Lorem.sentences(1),
        body: Faker.Lorem.sentences(4)
      }
    }
    data['category']['parent_id'] = parentId if parentId

    Resource.createResource(site, userId, sessionId, 'categories', data, onsuccess, onfail, oncreate)

module.exports = exports = Category