class Pod
  $ = require('jquery')

  @getServers = (site, onsuccess) ->
    Spaces = require('./spaces-client')
    headers = {
      "Accept": "application/vnd.moxiesoft.mothership-v1+json",
      "API-KEY": Spaces.apiKey
    }
    Spaces.Resource.getResource({ full_url: Spaces.mothershipUrl }, "system", null, 'api/pods', headers, ((msecs, pods) ->
      pod = $.grep(JSON.parse(pods), ((pod, n) ->
        pod.id == site.pod_id
      ))[0]
      onsuccess(pod.app_servers.length, pod.job_servers.length)
    ), ((e) ->
      Spaces.logger.info("POD: ERROR: %s", e)
    ))

module.exports = exports = Pod