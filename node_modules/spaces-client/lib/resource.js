// Generated by CoffeeScript 1.6.3
(function() {
  var Resource, exports;

  Resource = (function() {
    function Resource() {}

    Resource.deleteResource = function(site, userId, className) {
      var Spaces, id, post_options, post_req;
      Spaces = require('./spaces-client.js');
      id = Spaces.Session.getRandomUserItemIdOfType(site, userId, className);
      if (!id) {
        Spaces.logger.info("[%s][%s] No appropriate %s can be found", site.site_id, userId, className);
        return;
      }
      post_options = {
        hostname: site.full_url.match(/https:\/\/(.*)$/)[1],
        path: "/" + className + "s/" + id,
        method: 'DELETE',
        headers: {
          "Accept": 'application/vnd.moxiesoft.spaces-v1+json',
          "Cookie": ["_social_navigator_session=" + Spaces.Session.getSessionId(site, userId), "path=/"]
        }
      };
      post_req = require('https').request(post_options, (function(res) {
        res.setEncoding('utf8');
        return res.on('end', (function() {
          if (res.statusCode === 200 || res.statusCode === 201) {
            return Spaces.logger.debug("[%s][%s] Deleted %s [%s]", site.site_id, userId, className, id);
          } else {
            return Spaces.logger.debug("[%s][%s] %s#delete/%s failed: %d - %s", site.site_id, userId, className, id, res.statusCode, res.status);
          }
        }));
      }));
      post_req.on('error', (function(e) {
        return Spaces.logger.error("[%s][%s] %s#delete/%s failed: %s", site.site_id, userId, className, id, post_req.statusCode);
      }));
      return post_req.end();
    };

    return Resource;

  })();

  module.exports = exports = Resource;

}).call(this);
