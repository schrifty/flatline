class Session
  @sessions = {}
  @adminId = ""

  @setAdminId = (userId) ->
    @adminId = userId

  @setSessionId = (userId, id) ->
    @sessions[userId] = {} unless @sessions[userId]
    @sessions[userId]["id"] = id
#    console.log "Stored session ID [" + @sessions[userId]["id"] + "] for user [" + userId + "]"

  @getSessionId = (userId) ->
    if session = @sessions[userId]
      if sessionId = session["id"]
        return sessionId
      else
        console.log "Couldn't find ID within session for user [" + userId + "]"
    else
      console.log "Couldn't find session for user [" + userId + "]"

  @getRandomUserItemIdOfType = (userId, type) ->
    if @sessions[userId]
      if list = @sessions[userId][type]
        return list[Math.floor(Math.random() * list.length)]
      else
        console.log "That user has NO " + type + "s"
    else
      console.log "ERROR: user session not found"

  @getRandomSiteItemIdOfType = (siteId, type) ->
    if @sessions[siteId]
      if list = @sessions[siteId][type]
        return list[Math.floor(Math.random() * list.length)]
      else
        console.log "That site are NO " + type + "s"

  @addItem = (site, userId, type, item) ->
    console.log "[" + site.site_id + "][" + userId + "]: Added " + type + " [" + item + "]"
    if @sessions[userId]
      @sessions[userId][type] = [] unless @sessions[userId][type]
      @sessions[userId][type].push item
    else
      console.log "[" + site.site_id + "][" + userId + "]: ERROR: user session not found"

    # store the item for the site as well
    @sessions[site.id] = {} unless @sessions[site.id]
    @sessions[site.id][type] = [] unless @sessions[site.id][type]
    @sessions[site.id][type].push item

module.exports = exports = Session