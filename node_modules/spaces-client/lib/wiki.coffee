class Wiki
  Faker = require('faker')
  Resource = require('./resource')

  @createWiki = (site, sessionId, resourceId, parentId, userId, onsuccess, onfail, oncreate) ->
    data = {
      wiki: {
        name: Faker.Lorem.sentences(1),
        description: Faker.Lorem.sentences(4)
      }
    }
    data['wiki']['parent_id'] = parentId if parentId
    Resource.createResource(site, userId, sessionId, 'wikis', data, onsuccess, onfail, oncreate)

  @showWiki = (site, sessionId, resourceId, parentId, userId, onsuccess, onfail) ->
    addlHeaders = {
      "Accept": "application/vnd.moxiesoft.spaces-v1+json",
      "Cookie": ["_social_navigator_session=" + sessionId, "path=/"]
    }
    Resource.getResource(site, userId, sessionId, 'wikis/' + resourceId, addlHeaders, onsuccess, onfail)

  @updateWiki = (site, sessionId, resourceId, parentId, userId, onsuccess, onfail) ->
    data = {
      wiki: {
        description: Faker.Lorem.sentences(4)
      }
    }
    Resource.editResource(site, userId, sessionId, 'wikis/' + resourceId, data, onsuccess, onfail)

  @deleteWiki = (site, sessionId, resourceId, parentId, userId, onsuccess, onfail, ondestroy) ->
    Resource.deleteResource(site, userId, sessionId, 'wikis/' + resourceId, onsuccess, onfail, ondestroy)

  @createWikipage = (site, sessionId, resourceId, parentId, userId, onsuccess, onfail, oncreate) ->
    data = {
      wiki_page: {
        title: Faker.Lorem.sentences(1)
        body: Faker.Lorem.sentences(4)
        parent_id: parentId
      }
    }
    Resource.createResource(site, userId, sessionId, 'wiki_pages', data, onsuccess, onfail, oncreate)

  @showWikipage = (site, sessionId, resourceId, parentId, userId, onsuccess, onfail) ->
    addlHeaders = {
      "Accept": "application/vnd.moxiesoft.spaces-v1+json",
      "Cookie": ["_social_navigator_session=" + sessionId, "path=/"]
    }
    Resource.getResource(site, userId, sessionId, 'wiki_pages/' + resourceId, addlHeaders, onsuccess, onfail)

  @updateWikipage = (site, sessionId, resourceId, parentId, userId, onsuccess, onfail) ->
    data = {
      wiki_page: {
        body: Faker.Lorem.sentences(4)
      }
    }
    Resource.editResource(site, userId, sessionId, 'wiki_pages/' + resourceId, data, onsuccess, onfail)

  @deleteWikipage = (site, sessionId, resourceId, parentId, userId, onsuccess, onfail, ondestroy) ->
    Resource.deleteResource(site, userId, sessionId, 'wiki_pages/' + resourceId, onsuccess, onfail, ondestroy)

module.exports = exports = Wiki